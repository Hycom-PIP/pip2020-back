pipeline {
    agent any
    stages {
      stage('Build') {
                steps {
                    sh 'mvn clean install -DskipTests'
                }
            }
      stage('Run') {
                steps {
                     sh 'java -jar -Dspring.profiles.active=test api/target/api.jar &'
                     // Wait until launch application
                     sh 'sleep 5s'
                     dir('integration-tests') {
                             sh 'mvn test -PfullTests'
                     }
                }
            }
    }
}

